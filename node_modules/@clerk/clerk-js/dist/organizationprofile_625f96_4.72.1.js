"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([[837],{6912:function(e,i,a){a.d(i,{B:function(){return h}});var o=a(4380),n=a(9859),t=a(4041),r=a(4740),l=a(9333),s=a(2932),d=a(3209),c=a(2234),u=a(166),g=a(3150),m=a(2596);const v=e=>/^\S+@\S+\.\S+$/.test(e),h=e=>{const{navigate:i}=(0,u.useRouter)(),{onSuccess:a,onReset:d=(()=>i("..")),resetButtonLabel:m}=e,{organization:h,invitations:p}=(0,r.useCoreOrganization)({invitations:{pageSize:10,keepPreviousData:!0}}),b=(0,s.useCardState)(),{t:f,locale:P}=(0,c._R)(),[y,Y]=(0,t.useState)(!1),S=(0,g.tJ)("emailAddress","",{type:"text",label:(0,c.GQ)("formFieldLabel__emailAddresses")}),_=(0,g.tJ)("role","",{label:(0,c.GQ)("formFieldLabel__role")});if(!h)return null;const{props:{setError:D,setWarning:C,setSuccess:x,setInfo:K,validatePassword:T,setHasPassedComplexity:F,hasPassedComplexity:R,feedback:w,feedbackType:L,clearFeedback:M,...k}}=S,B=(!!S.value.length||y)&&!!_.value;return(0,o.FD)(s.Form.Root,{onSubmit:e=>{e.preventDefault();const i=new FormData(e.currentTarget);return h.inviteMembers({emailAddresses:S.value.split(","),role:i.get("role")}).then((async()=>{var e;return await(null===(e=null==p?void 0:p.revalidate)||void 0===e?void 0:e.call(p)),a()})).catch((e=>{var i,a,o;if((0,n.$R)(e)&&(e=>{var i,a,o,n;const t=new Set([...null!==(a=null===(i=e.meta)||void 0===i?void 0:i.emailAddresses)&&void 0!==a?a:[],...null!==(n=null===(o=e.meta)||void 0===o?void 0:o.identifiers)&&void 0!==n?n:[]]),r=S.value.split(",");S.setValue(r.filter((e=>!t.has(e))).join(","))})(e.errors[0]),(0,n.$R)(e)&&"duplicate_record"===(null===(a=null===(i=e.errors)||void 0===i?void 0:i[0])||void 0===a?void 0:a.code)){const i=(null===(o=e.errors[0].meta)||void 0===o?void 0:o.emailAddresses)||[];b.setError(f((0,c.GQ)("organizationProfile.invitePage.detailsTitle__inviteFailed",{email_addresses:(0,g.kS)(i,P)})))}else(0,g.H4)(e,[],b.setError)}))},children:[(0,o.Y)(s.Form.ControlRow,{elementId:S.id,children:(0,o.FD)(l.Flex,{direction:"col",gap:2,sx:{width:"100%"},children:[(0,o.Y)(l.Text,{localizationKey:(0,c.GQ)("formFieldLabel__emailAddresses")}),(0,o.Y)(l.Text,{localizationKey:(0,c.GQ)("formFieldInputPlaceholder__emailAddresses"),colorScheme:"neutral",sx:e=>({fontSize:e.fontSizes.$xs})}),(0,o.Y)(s.TagInput,{...k,autoFocus:!0,validate:v,sx:{width:"100%"},validateUnsubmittedEmail:e=>Y(v(e))})]})}),(0,o.Y)(z,{..._}),(0,o.FD)(s.FormButtonContainer,{children:[(0,o.Y)(s.Form.SubmitButton,{block:!1,isDisabled:!B,localizationKey:(0,c.GQ)("organizationProfile.invitePage.formButtonPrimary__continue")}),(0,o.Y)(s.Form.ResetButton,{localizationKey:m||(0,c.GQ)("userProfile.formButtonReset"),block:!1,onClick:d})]})]})},z=e=>{const{options:i,isLoading:a}=(0,d.x)();return(0,o.Y)(s.Form.ControlRow,{elementId:e.id,children:(0,o.FD)(l.Flex,{direction:"col",gap:2,children:[(0,o.Y)(l.Text,{localizationKey:e.label}),(0,o.Y)(m.Vo,{...e.props,roles:i,isDisabled:a,onChange:i=>e.setValue(i),triggerSx:e=>({width:e.sizes.$48,justifyContent:"space-between",display:"flex"}),optionListSx:e=>({minWidth:e.sizes.$48})})]})})}},1228:function(e,i,a){a.d(i,{k:function(){return h},I:function(){return v}});var o=a(4380),n=a(1857),t=a(5220),r=a(4740),l=a(9333),s=a(2932),d=a(2407),c=a(166);const u=({__unstable_manageBillingUrl:e,__unstable_manageBillingMembersLimit:i})=>{const a=(0,c.useRouter)();return(0,o.FD)(l.Flex,{sx:e=>({background:e.colors.$blackAlpha50,padding:e.space.$4,borderRadius:e.radii.$md}),children:[(0,o.Y)(l.AlertIcon,{variant:"warning",colorScheme:"danger",sx:e=>({marginTop:e.space.$1})}),(0,o.FD)(l.Text,{variant:"regularRegular",sx:e=>({fontWeight:e.fontWeights.$normal,lineHeight:e.lineHeights.$tall}),children:["This organization is limited to ",(0,n.Mo)(i)," members.",(0,o.Y)("br",{}),(0,o.Y)(l.Link,{variant:"regularRegular",sx:e=>({alignSelf:"flex-start",color:e.colors.$primary500,fontWeight:e.fontWeights.$normal}),onClick:()=>a.navigate((0,n.Mo)(e)),children:"Upgrade for unlimited members"})]})]})};var g=a(6912),m=a(9428);const v=(0,s.withCardStateProvider)((()=>{const e=(0,l.localizationKeys)("organizationProfile.invitePage.title"),i=(0,l.localizationKeys)("organizationProfile.invitePage.subtitle"),a=(0,s.useCardState)(),d=(0,t.Xi)({onNextStep:()=>a.setError(void 0)}),{organization:c}=(0,r.useCoreOrganization)(),{__unstable_manageBillingUrl:v,__unstable_manageBillingMembersLimit:z}=(0,r.useOrganizationProfileContext)();if(!c)return null;const p=!!z&&(0,n.Mo)(z)<=c.pendingInvitationsCount+c.membersCount;return(0,o.FD)(t.sQ,{...d.props,children:[(0,o.FD)(s.ContentPage,{headerTitle:e,headerSubtitle:i,Breadcrumbs:m.p,children:[p&&v&&(0,o.Y)(u,{__unstable_manageBillingUrl:v,__unstable_manageBillingMembersLimit:z}),(0,o.Y)(g.B,{onSuccess:d.nextStep})]}),(0,o.Y)(s.SuccessPage,{title:e,contents:(0,o.Y)(h,{}),Breadcrumbs:m.p})]})})),h=()=>(0,o.FD)(l.Flex,{direction:"col",center:!0,gap:4,children:[(0,o.Y)(s.IconCircle,{boxElementDescriptor:l.descriptors.invitationsSentIconBox,iconElementDescriptor:l.descriptors.invitationsSentIcon,icon:d.Ps}),(0,o.Y)(l.Text,{localizationKey:(0,l.localizationKeys)("organizationProfile.invitePage.successMessage")})]})},2596:function(e,i,a){a.d(i,{Vo:function(){return c},Yq:function(){return d},bQ:function(){return l}});var o=a(4380),n=(a(4041),a(9333)),t=a(2932),r=a(3209);const l=e=>{const{headers:i,page:a,onPageChange:r,rows:l,isLoading:d,itemCount:c,itemsPerPage:u,pageCount:g,emptyStateLocalizationKey:m}=e,v=c>0?Math.max(0,(a-1)*u)+1:0,h=Math.min(a*u,c);return(0,o.FD)(n.Col,{gap:4,sx:{width:"100%"},children:[(0,o.Y)(n.Flex,{sx:{overflowX:"auto"},children:(0,o.FD)(n.Table,{sx:{width:"100%"},children:[(0,o.Y)(n.Thead,{children:(0,o.Y)(n.Tr,{children:i.map(((e,i)=>(0,o.Y)(n.Th,{elementDescriptor:n.descriptors.tableHead,localizationKey:e},i)))})}),(0,o.Y)(n.Tbody,{children:d?(0,o.Y)(n.Tr,{children:(0,o.Y)(n.Td,{colSpan:4,children:(0,o.Y)(n.Spinner,{colorScheme:"primary",sx:{margin:"auto",display:"block"}})})}):l.length?l:(0,o.Y)(s,{localizationKey:m},"empty")})]})}),(0,o.Y)(t.Pagination,{count:g,page:a,onChange:r,siblingCount:1,rowInfo:{allRowsCount:c,startingRow:v,endingRow:h}})]})},s=e=>(0,o.Y)(n.Tr,{children:(0,o.Y)(n.Td,{colSpan:4,children:(0,o.Y)(n.Text,{localizationKey:e.localizationKey,sx:e=>({margin:"auto",display:"block",width:"fit-content",fontSize:e.fontSizes.$xs})})})}),d=e=>(0,o.Y)(n.Tr,{...e,sx:e=>({":hover":{backgroundColor:e.colors.$blackAlpha50}})}),c=e=>{const{value:i,roles:a,onChange:n,isDisabled:l,triggerSx:s,optionListSx:d}=e,c=!a,u=[{label:"admin",value:"admin"},{label:"basic_member",value:"basic_member"}],{localizeCustomRole:g}=(0,r.l)(),m=[...a||[],...u,{label:"guest_member",value:"guest_member"}].find((e=>e.value===i)),v=(c?u:a).map((e=>({value:e.value,label:g(e.value)||e.label})));return(0,o.FD)(t.Select,{elementId:"role",options:v,value:i,onChange:e=>n(e.value),children:[(0,o.Y)("input",{name:"role",type:"hidden",value:i}),(0,o.Y)(t.SelectButton,{sx:s||(e=>({color:e.colors.$colorTextSecondary,backgroundColor:"transparent"})),isDisabled:l,children:g(null==m?void 0:m.value)||(null==m?void 0:m.label)}),(0,o.Y)(t.SelectOptionList,{sx:d})]})}},699:function(e,i,a){a.d(i,{i:function(){return r}});var o=a(4380),n=a(2932),t=a(2234);const r=e=>{const{organization:i,...a}=e;return(0,o.Y)(n.AvatarUploader,{...a,title:(0,t.GQ)("userProfile.profilePage.imageFormTitle"),avatarPreview:(0,o.Y)(n.OrganizationAvatar,{size:e=>e.sizes.$11,...i})})}},9428:function(e,i,a){a.d(i,{l:function(){return s},p:function(){return d}});var o=a(4380),n=(a(4041),a(5220)),t=a(2237),r=a(4740),l=a(2932);const s=e=>{const{organization:i}=(0,r.useCoreOrganization)(),{pages:a}=(0,r.useOrganizationProfileContext)(),{isAuthorizedUser:s}=(0,n.Zj)((e=>e({permission:"org:sys_memberships:read"})||e({permission:"org:sys_memberships:manage"})));return i?(0,o.FD)(l.NavbarContextProvider,{children:[(0,o.Y)(l.NavBar,{header:(0,o.Y)(l.OrganizationPreview,{size:"sm",organization:i,sx:e=>({margin:`0 0 ${e.space.$4} ${e.space.$2}`})}),routes:a.routes.filter((e=>e.id!==t.j.MEMBERS||e.id===t.j.MEMBERS&&s)),contentRef:e.contentRef}),e.children]}):null},d=e=>{const{pages:i}=(0,r.useOrganizationProfileContext)();return(0,o.Y)(l.Breadcrumbs,{...e,pageToRootNavbarRoute:i.pageToRootNavbarRouteMap})}},114:function(e,i,a){a.r(i),a.d(i,{OrganizationProfile:function(){return re},OrganizationProfileModal:function(){return le}});var o=a(4380),n=a(4041),t=a(5220),r=a(4740),l=a(9333),s=a(2932),d=a(166),c=a(9428),u=a(9834),g=a(3150),m=a(4683);const v=e=>{const i=(0,s.useCardState)(),{navigateAfterLeaveOrganization:a}=(0,r.useOrganizationProfileContext)(),{userMemberships:o,userInvitations:n}=(0,r.useCoreOrganizationList)({userMemberships:m.mu.userMemberships,userInvitations:m.mu.userInvitations});return()=>i.runAsync((async()=>{await(null==e?void 0:e())})).then((()=>{var e,i;null===(e=o.revalidate)||void 0===e||e.call(o),null===(i=n.revalidate)||void 0===i||i.call(n),a()}))},h=()=>{const{organization:e}=(0,r.useCoreOrganization)(),i=(0,r.useCoreUser)(),a=v(e?()=>i.leaveOrganization(e.id):void 0);return e&&i?(0,o.Y)(p,{organizationName:null==e?void 0:e.name,title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),messageLine1:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.messageLine1"),messageLine2:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.messageLine2"),actionDescription:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.actionDescription",{organizationName:null==e?void 0:e.name}),submitLabel:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),successMessage:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.successMessage"),onConfirmation:a}):null},z=()=>{const{organization:e,membership:i}=(0,r.useCoreOrganization)(),a=v(null==e?void 0:e.destroy);return e&&i?(0,o.Y)(p,{organizationName:null==e?void 0:e.name,title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),messageLine1:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.messageLine1"),messageLine2:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.messageLine2"),actionDescription:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.actionDescription",{organizationName:null==e?void 0:e.name}),submitLabel:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),successMessage:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.successMessage"),onConfirmation:a}):null},p=(0,s.withCardStateProvider)((e=>{const{title:i,messageLine1:a,messageLine2:n,actionDescription:r,organizationName:u,successMessage:m,submitLabel:v,onConfirmation:h,colorScheme:z="danger"}=e,p=(0,t.Xi)(),b=(0,s.useCardState)(),{navigate:f}=(0,d.useRouter)(),P=(0,g.tJ)("deleteOrganizationConfirmation","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__confirmDeletion"),isRequired:!0,placeholder:u}),y=!r||P.value===u;return(0,o.FD)(t.sQ,{...p.props,children:[(0,o.Y)(s.ContentPage,{headerTitle:i,breadcrumbTitle:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.title"),Breadcrumbs:c.p,children:(0,o.FD)(s.Form.Root,{onSubmit:async()=>{if(y)try{await h().then((()=>p.nextStep()))}catch(e){(0,g.H4)(e,[],b.setError)}},children:[(0,o.Y)(l.Text,{localizationKey:a}),(0,o.Y)(l.Text,{localizationKey:n}),(0,o.Y)(l.Text,{localizationKey:r}),(0,o.Y)(s.Form.ControlRow,{elementId:P.id,children:(0,o.Y)(s.Form.Control,{...P.props,required:!0})}),(0,o.FD)(s.FormButtonContainer,{children:[(0,o.Y)(s.Form.SubmitButton,{block:!1,colorScheme:z,localizationKey:v,isDisabled:!y}),(0,o.Y)(s.Form.ResetButton,{localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),block:!1,onClick:async()=>{await f("..")}})]})]})}),(0,o.Y)(s.SuccessPage,{title:i,text:m})]})})),b=(0,s.withCardStateProvider)((()=>{const{organizationSettings:e}=(0,r.useEnvironment)(),i=(0,l.localizationKeys)("organizationProfile.createDomainPage.title"),a=(0,l.localizationKeys)("organizationProfile.createDomainPage.subtitle"),n=(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),t=(0,s.useCardState)(),{organization:u}=(0,r.useCoreOrganization)(),{navigate:m}=(0,d.useRouter)(),v=(0,g.tJ)("name","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationDomain"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationDomain")});if(!u||!e)return null;const h=""!==v.value.trim();return(0,o.Y)(s.ContentPage,{headerTitle:i,headerSubtitle:a,breadcrumbTitle:n,Breadcrumbs:c.p,children:(0,o.FD)(s.Form.Root,{onSubmit:e=>(v.setError(void 0),e.preventDefault(),u.createDomain(v.value).then((e=>e.verification&&"verified"===e.verification.status?m(`../domain/${e.id}?mode=select`):m(`../domain/${e.id}/verify`))).catch((e=>{(0,g.H4)(e,[v],t.setError)}))),children:[(0,o.Y)(s.Form.ControlRow,{elementId:v.id,children:(0,o.Y)(s.Form.Control,{...v.props,autoFocus:!0,required:!0})}),(0,o.Y)(s.FormButtons,{isDisabled:!h})]})})}));var f=a(1228),P=a(3803),y=a(3209),Y=a(2596);const S={memberships:{pageSize:10,keepPreviousData:!0}},_=()=>{const e=(0,s.useCardState)(),{organization:i,memberships:a}=(0,r.useCoreOrganization)(S),{options:n,isLoading:t}=(0,y.x)();if(!i)return null;const d=i=>async()=>e.runAsync((async()=>{var e;const o=await i.destroy();return await(null===(e=null==a?void 0:a.revalidate)||void 0===e?void 0:e.call(a)),o})).catch((i=>(0,g.H4)(i,[],e.setError)));return(0,o.Y)(Y.bQ,{page:(null==a?void 0:a.page)||1,onPageChange:e=>{var i;return null===(i=null==a?void 0:a.fetchPage)||void 0===i?void 0:i.call(a,e)},itemCount:(null==a?void 0:a.count)||0,pageCount:(null==a?void 0:a.pageCount)||0,itemsPerPage:S.memberships.pageSize,isLoading:(null==a?void 0:a.isLoading)||t,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.detailsTitle__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__joined"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__role"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==a?void 0:a.data)||[]).map((i=>{return(0,o.Y)(D,{membership:i,options:n,onRoleChange:(a=i,i=>e.runAsync((async()=>await a.update({role:i}))).catch((i=>(0,g.H4)(i,[],e.setError)))),onRemove:d(i)},i.id);var a}))})},D=e=>{var i;const{membership:a,onRemove:n,onRoleChange:t,options:d}=e,{localizeCustomRole:c}=(0,y.l)(),u=(0,s.useCardState)(),g=(0,r.useCoreUser)().id===a.publicUserData.userId,m=null===(i=null==d?void 0:d.find((e=>e.value===a.role)))||void 0===i?void 0:i.label;return(0,o.FD)(Y.Yq,{children:[(0,o.Y)(l.Td,{children:(0,o.Y)(s.UserPreview,{sx:{maxWidth:"30ch"},user:a.publicUserData,subtitle:a.publicUserData.identifier,badge:g&&(0,o.Y)(l.Badge,{textVariant:"extraSmallMedium",localizationKey:(0,l.localizationKeys)("badge__you")})})}),(0,o.Y)(l.Td,{children:a.createdAt.toLocaleDateString()}),(0,o.Y)(l.Td,{children:(0,o.Y)(P.iD,{permission:"org:sys_memberships:manage",fallback:(0,o.Y)(l.Text,{sx:e=>({opacity:e.opacity.$inactive}),children:c(a.role)||m}),children:(0,o.Y)(Y.Vo,{isDisabled:u.isLoading||!t,value:a.role,onChange:t,roles:d})})}),(0,o.Y)(l.Td,{children:(0,o.Y)(P.iD,{permission:"org:sys_memberships:manage",children:(0,o.Y)(s.ThreeDotsMenu,{actions:[{label:(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.menuAction__remove"),isDestructive:!0,onClick:n,isDisabled:g}],elementId:"member"})})})]})};var C=a(1857);const x=()=>{const{organization:e}=(0,r.useCoreOrganization)(),{__unstable_manageBillingUrl:i,__unstable_manageBillingLabel:a,__unstable_manageBillingMembersLimit:n}=(0,r.useOrganizationProfileContext)(),t=(0,d.useRouter)();if(!e)return null;const s=(null==e?void 0:e.membersCount)+(null==e?void 0:e.pendingInvitationsCount);return(0,o.FD)(l.Flex,{sx:e=>({background:e.colors.$blackAlpha50,padding:e.space.$4,justifyContent:"space-between",alignItems:"flex-start",borderRadius:e.radii.$md}),children:[(0,o.FD)(l.Col,{children:[(0,o.Y)(l.Text,{sx:e=>({lineHeight:e.lineHeights.$tall}),children:"Members can be given access to applications."}),(0,C.Mo)(n)>0&&(0,o.Y)(l.Link,{variant:"regularRegular",sx:e=>({alignSelf:"flex-start",color:e.colors.$primary500,marginTop:e.space.$1,fontWeight:e.fontWeights.$normal}),onClick:()=>t.navigate((0,C.Mo)(i)),children:(0,C.Mo)(a)||"Manage billing"})]}),(0,o.Y)(l.Col,{children:(0,o.FD)(l.Text,{variant:"regularRegular",sx:e=>({fontWeight:e.fontWeights.$normal,lineHeight:e.lineHeights.$tall,color:e.colors.$blackAlpha600}),children:[s," of"," ",n?`${(0,C.Mo)(n)} members`:"unlimited"]})})]})};var K=a(2407),T=a(7157);const F={manual_invitation:(0,l.localizationKeys)("organizationProfile.badge__manualInvitation"),automatic_invitation:(0,l.localizationKeys)("organizationProfile.badge__automaticInvitation"),automatic_suggestion:(0,l.localizationKeys)("organizationProfile.badge__automaticSuggestion")},R=e=>{const{organizationDomain:i}=e;return i?i.verification&&"verified"===i.verification.status?(0,o.Y)(l.Badge,{localizationKey:F[i.enrollmentMode],colorScheme:"manual_invitation"===i.enrollmentMode?"neutral":"primary",textVariant:"extraSmallMedium"}):(0,o.Y)(l.Badge,{localizationKey:(0,l.localizationKeys)("organizationProfile.badge__unverified"),textVariant:"extraSmallMedium",colorScheme:"danger"}):null},w=(e,i,a)=>(0,C.iD)((0,C.FV)((0,C.Xz)(`${e}/${i}/${a||""}`))),L=({redirectSubPath:e,domainId:i})=>{const a=((e,i)=>{const{isAuthorizedUser:a}=(0,t.Zj)({permission:"org:sys_domains:manage"}),{navigate:o}=(0,d.useRouter)(),n=[];return a&&(n.push({label:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.unverifiedDomain_menuAction__verify"),onClick:()=>o(w(e,i,"verify"))}),n.push({label:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.unverifiedDomain_menuAction__remove"),isDestructive:!0,onClick:()=>o(w(e,i,"remove"))})),n})(e,i);return(0,o.Y)(s.ThreeDotsMenu,{actions:a})},M=(0,t.ki)((e=>{const{verificationStatus:i,enrollmentMode:a,redirectSubPath:c,fallback:u,...g}=e,{organization:m,domains:v}=(0,r.useCoreOrganization)({domains:{infinite:!0,...g}}),{isAuthorizedUser:h}=(0,t.Zj)({permission:"org:sys_domains:manage"}),{ref:z}=(0,T.Wx)({threshold:0,onChange:e=>{var i;e&&(null===(i=null==v?void 0:v.fetchNext)||void 0===i||i.call(v))}}),{navigate:p}=(0,d.useRouter)(),{pathToDomainPage:b}=(0,r.useOrganizationProfileContext)(),f=(0,n.useMemo)((()=>(null==v?void 0:v.data)?v.data.filter((e=>{let o=!0,n=!0;return i&&(o=!!e.verification&&e.verification.status===i),a&&(n=e.enrollmentMode===a),o&&n})):[]),[null==v?void 0:v.data]);return m?(0,o.FD)(l.Col,{children:[0===f.length&&!(null==v?void 0:v.isLoading)&&u,f.map((e=>e.verification&&"verified"===e.verification.status&&h?(0,o.Y)(s.ArrowBlockButton,{variant:"ghost",colorScheme:"neutral",badge:i?void 0:(0,o.Y)(R,{organizationDomain:e}),sx:e=>({padding:`${e.space.$3} ${e.space.$4}`,minHeight:e.sizes.$10}),onClick:()=>p("domain"===c?(0,C.iD)((0,C.FV)((0,C.Xz)(`domain/${e.id}`))):(0,C.iD)(`${b}/${e.id}`)),children:e.name},e.id):(0,o.Y)(s.BlockWithTrailingComponent,{sx:e=>({"&:hover":{backgroundColor:e.colors.$blackAlpha50},padding:`${e.space.$none} ${e.space.$4}`,minHeight:e.sizes.$10}),badge:(0,o.Y)(R,{organizationDomain:e}),trailingComponent:h?(0,o.Y)(L,{redirectSubPath:c,domainId:e.id}):void 0,children:e.name},e.id))),((null==v?void 0:v.hasNextPage)||(null==v?void 0:v.isFetching))&&(0,o.Y)(l.Box,{ref:(null==v?void 0:v.isFetching)?void 0:z,sx:[e=>({width:"100%",height:e.space.$10,position:"relative"})],children:(0,o.Y)(l.Box,{sx:{display:"flex",margin:"auto",position:"absolute",left:"50%",top:"50%",transform:"translateY(-50%) translateX(-50%)"},children:(0,o.Y)(l.Spinner,{size:"sm",colorScheme:"primary"})})})]}):null}),{permission:"org:sys_domains:read"}),k={invitations:{pageSize:10,keepPreviousData:!0}},B=()=>{const e=(0,s.useCardState)(),{organization:i,invitations:a}=(0,r.useCoreOrganization)(k),{options:n,isLoading:t}=(0,y.x)();return i?(0,o.Y)(Y.bQ,{page:(null==a?void 0:a.page)||1,onPageChange:(null==a?void 0:a.fetchPage)||(()=>null),itemCount:(null==a?void 0:a.count)||0,pageCount:(null==a?void 0:a.pageCount)||0,itemsPerPage:k.invitations.pageSize,isLoading:(null==a?void 0:a.isLoading)||t,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.table__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.invitedMembersTab.tableHeader__invited"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__role"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==a?void 0:a.data)||[]).map((i=>{return(0,o.Y)($,{options:n,invitation:i,onRevoke:(t=i,async()=>e.runAsync((async()=>{var e;return await t.revoke(),await(null===(e=null==a?void 0:a.revalidate)||void 0===e?void 0:e.call(a)),t})).catch((i=>(0,g.H4)(i,[],e.setError))))},i.id);var t}))}):null},$=e=>{var i;const{invitation:a,onRevoke:n,options:t}=e,{localizeCustomRole:r}=(0,y.l)(),d=null===(i=null==t?void 0:t.find((e=>e.value===a.role)))||void 0===i?void 0:i.label;return(0,o.FD)(Y.Yq,{children:[(0,o.Y)(l.Td,{children:(0,o.Y)(s.UserPreview,{sx:{maxWidth:"30ch"},user:{primaryEmailAddress:{emailAddress:a.emailAddress}}})}),(0,o.Y)(l.Td,{children:a.createdAt.toLocaleDateString()}),(0,o.Y)(l.Td,{children:(0,o.Y)(l.Text,{colorScheme:"neutral",localizationKey:r(a.role)||d})}),(0,o.Y)(l.Td,{children:(0,o.Y)(s.ThreeDotsMenu,{actions:[{label:(0,l.localizationKeys)("organizationProfile.membersPage.invitedMembersTab.menuAction__revoke"),isDestructive:!0,onClick:n}],elementId:"invitation"})})]})},I=()=>{var e;const{organizationSettings:i}=(0,r.useEnvironment)(),{navigate:a}=(0,d.useRouter)(),{__unstable_manageBillingUrl:n,navigateToAddDomainPage:c}=(0,r.useOrganizationProfileContext)(),u=null===(e=null==i?void 0:i.domains)||void 0===e?void 0:e.enabled;return(0,o.FD)(l.Col,{gap:8,sx:{width:"100%"},children:[n&&(0,o.Y)(x,{}),u&&(0,o.Y)(t.iD,{permission:"org:sys_domains:manage",children:(0,o.FD)(l.Col,{gap:2,sx:{width:"100%"},children:[(0,o.FD)(s.Header.Root,{children:[(0,o.Y)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.headerTitle"),textVariant:"largeMedium"}),(0,o.Y)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.headerSubtitle"),variant:"regularRegular"})]}),(0,o.Y)(M,{fallback:(0,o.Y)(t.u3,{colorScheme:"primary",textLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.primaryButton"),id:"manageVerifiedDomains",onClick:c}),redirectSubPath:"organization-settings/domain",verificationStatus:"verified",enrollmentMode:"automatic_invitation"})]})}),(0,o.FD)(l.Flex,{direction:"col",gap:4,sx:{width:"100%"},children:[(0,o.FD)(l.Flex,{justify:"between",align:"center",children:[(0,o.FD)(s.Header.Root,{children:[(0,o.Y)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.manualInvitations.headerTitle"),textVariant:"largeMedium"}),(0,o.Y)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.manualInvitations.headerSubtitle"),variant:"regularRegular"})]}),(0,o.Y)(s.IconButton,{elementDescriptor:l.descriptors.membersPageInviteButton,"aria-label":"Invite",onClick:()=>a("invite-members"),icon:(0,o.Y)(l.Icon,{icon:K.vz,size:"sm",sx:e=>({marginRight:e.space.$2})}),textVariant:"buttonExtraSmallBold",localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.action__invite")})]}),(0,o.Y)(B,{})]})]})},O={membershipRequests:{pageSize:10,keepPreviousData:!0}},H=()=>{var e;const i=(0,s.useCardState)(),{organization:a,membershipRequests:n}=(0,r.useCoreOrganization)(O);return a?(0,o.Y)(Y.bQ,{page:(null==n?void 0:n.page)||1,onPageChange:null!==(e=null==n?void 0:n.fetchPage)&&void 0!==e?e:()=>null,itemCount:(null==n?void 0:n.count)||0,pageCount:(null==n?void 0:n.pageCount)||0,itemsPerPage:O.membershipRequests.pageSize,isLoading:null==n?void 0:n.isLoading,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.table__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.tableHeader__requested"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==n?void 0:n.data)||[]).map((e=>(0,o.Y)(A,{request:e,onError:i.setError},e.id)))}):null},A=(0,s.withCardStateProvider)((e=>{const{request:i,onError:a}=e,n=(0,s.useCardState)(),{membership:t,membershipRequests:d}=(0,r.useCoreOrganization)(O);return(0,o.FD)(Y.Yq,{children:[(0,o.Y)(l.Td,{children:(0,o.Y)(s.UserPreview,{sx:{maxWidth:"30ch"},showAvatar:!1,user:{primaryEmailAddress:{emailAddress:i.publicUserData.identifier}}})}),(0,o.Y)(l.Td,{children:i.createdAt.toLocaleDateString()}),(0,o.Y)(l.Td,{children:(0,o.Y)(E,{onAccept:()=>{if(t&&d)return n.runAsync((async()=>{await i.accept(),await d.revalidate()}),"accept").catch((e=>(0,g.H4)(e,[],a)))},onReject:()=>{if(t&&d)return n.runAsync((async()=>{await i.reject(),await d.revalidate()}),"reject").catch((e=>(0,g.H4)(e,[],a)))}})})]})})),E=e=>{const i=(0,s.useCardState)();return(0,o.FD)(l.Flex,{gap:2,children:[(0,o.Y)(l.Button,{textVariant:"buttonExtraSmallBold",variant:"ghost",isLoading:i.isLoading&&"reject"===i.loadingMetadata,isDisabled:i.isLoading&&"reject"!==i.loadingMetadata,onClick:e.onReject,localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.menuAction__reject")}),(0,o.Y)(l.Button,{textVariant:"buttonExtraSmallBold",variant:"solid",isLoading:i.isLoading&&"accept"===i.loadingMetadata,isDisabled:i.isLoading&&"accept"!==i.loadingMetadata,onClick:e.onAccept,localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.menuAction__approve")})]})},q=()=>{var e;const{organizationSettings:i}=(0,r.useEnvironment)(),{__unstable_manageBillingUrl:a,navigateToAddDomainPage:n}=(0,r.useOrganizationProfileContext)(),d=null===(e=null==i?void 0:i.domains)||void 0===e?void 0:e.enabled;return(0,o.FD)(l.Col,{gap:8,sx:{width:"100%"},children:[a&&(0,o.Y)(x,{}),d&&(0,o.Y)(t.iD,{permission:"org:sys_domains:manage",children:(0,o.FD)(l.Col,{gap:2,sx:{width:"100%"},children:[(0,o.FD)(s.Header.Root,{children:[(0,o.Y)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.headerTitle"),textVariant:"largeMedium"}),(0,o.Y)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.headerSubtitle"),variant:"regularRegular"})]}),(0,o.Y)(M,{fallback:(0,o.Y)(t.u3,{colorScheme:"primary",textLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.primaryButton"),id:"manageVerifiedDomains",onClick:n}),redirectSubPath:"organization-settings/domain",verificationStatus:"verified",enrollmentMode:"automatic_suggestion"})]})}),(0,o.FD)(l.Flex,{direction:"col",gap:4,sx:{width:"100%"},children:[(0,o.Y)(l.Flex,{justify:"between",align:"center",children:(0,o.FD)(s.Header.Root,{children:[(0,o.Y)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.requests.headerTitle"),textVariant:"largeMedium"}),(0,o.Y)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.requests.headerSubtitle"),variant:"regularRegular"})]})}),(0,o.Y)(H,{})]})]})},V=(0,s.withCardStateProvider)((()=>{var e;const{organizationSettings:i}=(0,r.useEnvironment)(),a=(0,s.useCardState)(),{isAuthorizedUser:n}=(0,t.Zj)({permission:"org:sys_memberships:manage"}),{isAuthorizedUser:d}=(0,t.Zj)({permission:"org:sys_memberships:read"}),c=null===(e=null==i?void 0:i.domains)||void 0===e?void 0:e.enabled,{membershipRequests:u}=(0,r.useCoreOrganization)({membershipRequests:c||void 0}),{__unstable_manageBillingUrl:g}=(0,r.useOrganizationProfileContext)();return null===n?null:(0,o.FD)(l.Col,{elementDescriptor:l.descriptors.page,gap:8,children:[(0,o.Y)(s.CardAlert,{children:a.error}),(0,o.Y)(s.NavbarMenuButtonRow,{}),(0,o.FD)(l.Col,{elementDescriptor:l.descriptors.profilePage,elementId:l.descriptors.profilePage.setId("organizationMembers"),gap:8,children:[(0,o.FD)(s.Header.Root,{children:[(0,o.Y)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerTitle__members"),textVariant:"xxlargeMedium"}),(0,o.Y)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerSubtitle__members")})]}),(0,o.FD)(s.Tabs,{children:[(0,o.FD)(s.TabsList,{children:[d&&(0,o.Y)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__members")}),n&&(0,o.Y)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__invitations")}),n&&c&&(0,o.Y)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__requests"),children:(0,o.Y)(t.am,{notificationCount:(null==u?void 0:u.count)||0})})]}),(0,o.FD)(s.TabPanels,{children:[d&&(0,o.Y)(s.TabPanel,{sx:{width:"100%"},children:(0,o.FD)(l.Flex,{gap:4,direction:"col",sx:{width:"100%"},children:[n&&g&&(0,o.Y)(x,{}),(0,o.Y)(_,{})]})}),n&&(0,o.Y)(s.TabPanel,{sx:{width:"100%"},children:(0,o.Y)(I,{})}),n&&c&&(0,o.Y)(s.TabPanel,{sx:{width:"100%"},children:(0,o.Y)(q,{})})]})]})]})]})})),j=()=>(0,o.FD)(l.Col,{elementDescriptor:l.descriptors.page,gap:8,children:[(0,o.Y)(s.NavbarMenuButtonRow,{}),(0,o.FD)(l.Col,{elementDescriptor:l.descriptors.profilePage,elementId:l.descriptors.profilePage.setId("organizationSettings"),gap:8,children:[(0,o.FD)(s.Header.Root,{children:[(0,o.Y)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerTitle__settings"),textVariant:"xxlargeMedium"}),(0,o.Y)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerSubtitle__settings")})]}),(0,o.Y)(U,{}),(0,o.Y)(t.iD,{permission:"org:sys_domains:read",children:(0,o.Y)(N,{})}),(0,o.Y)(Q,{})]})]}),U=()=>{const{organization:e}=(0,r.useCoreOrganization)(),{navigate:i}=(0,d.useRouter)();if(!e)return null;const a=(0,o.Y)(s.OrganizationPreview,{organization:e,size:"lg"});return(0,o.Y)(s.ProfileSection,{title:(0,l.localizationKeys)("organizationProfile.profilePage.title"),id:"organizationProfile",children:(0,o.Y)(t.iD,{permission:"org:sys_profile:manage",fallback:(0,o.Y)(o.FK,{children:a}),children:(0,o.Y)(t.u3,{onClick:()=>i("profile"),children:a})})})},N=()=>{const{organizationSettings:e}=(0,r.useEnvironment)(),{organization:i}=(0,r.useCoreOrganization)(),{navigate:a}=(0,d.useRouter)();return e&&i&&e.domains.enabled?(0,o.FD)(s.ProfileSection,{title:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),subtitle:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.subtitle"),id:"organizationDomains",children:[(0,o.Y)(M,{redirectSubPath:"domain"}),(0,o.Y)(t.iD,{permission:"org:sys_domains:manage",children:(0,o.Y)(t.Ng,{textLocalizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.primaryButton"),id:"addOrganizationDomain",onClick:()=>a("domain")})})]}):null},Q=()=>{const{organization:e}=(0,r.useCoreOrganization)(),{navigate:i}=(0,d.useRouter)(),{isAuthorizedUser:a}=(0,t.Zj)({permission:"org:sys_profile:delete"});if(!e)return null;const n=e.adminDeleteEnabled;return(0,o.Y)(s.ProfileSection,{id:"organizationDanger",title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.title"),sx:e=>({marginBottom:e.space.$4}),children:(0,o.FD)(l.Flex,{gap:4,children:[(0,o.Y)(s.IconButton,{"aria-label":"Leave organization",icon:(0,o.Y)(l.Icon,{icon:K.Fq,size:"sm",sx:e=>({marginRight:e.space.$2})}),variant:"outline",colorScheme:"danger",textVariant:"buttonExtraSmallBold",onClick:()=>i("leave"),localizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title")}),a&&n&&(0,o.Y)(s.IconButton,{"aria-label":"Delete organization",icon:(0,o.Y)(l.Icon,{icon:K.Fq,size:"sm",sx:e=>({marginRight:e.space.$2})}),variant:"outline",colorScheme:"danger",textVariant:"buttonExtraSmallBold",onClick:()=>i("delete"),localizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title")})]})})};var W=a(699);const G=(0,s.withCardStateProvider)((()=>{const e=(0,l.localizationKeys)("organizationProfile.profilePage.title"),i=(0,l.localizationKeys)("organizationProfile.profilePage.subtitle"),a=(0,s.useCardState)(),[d,u]=n.useState(!1),{organization:m}=(0,r.useCoreOrganization)(),v=(0,t.Xi)({onNextStep:()=>a.setError(void 0)}),h=(0,g.tJ)("name",(null==m?void 0:m.name)||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationName"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationName")}),z=(0,g.tJ)("slug",(null==m?void 0:m.slug)||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationSlug"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationSlug")});if(!m)return null;const p=(m.name!==h.value||m.slug!==z.value||d)&&"error"!==z.feedbackType;return(0,o.FD)(t.sQ,{...v.props,children:[(0,o.Y)(s.ContentPage,{headerTitle:e,headerSubtitle:i,Breadcrumbs:c.p,children:(0,o.FD)(s.Form.Root,{onSubmit:async e=>(e.preventDefault(),(p?m.update({name:h.value,slug:z.value}):Promise.resolve()).then(v.nextStep).catch((e=>{(0,g.H4)(e,[h,z],a.setError)}))),children:[(0,o.Y)(W.i,{organization:m,onAvatarChange:e=>m.setLogo({file:e}).then((()=>{u(!0),a.setIdle()})).catch((e=>(0,g.H4)(e,[],a.setError))),onAvatarRemove:(0,C.px)(m.imageUrl)?null:()=>{m.setLogo({file:null}).then((()=>{u(!0),a.setIdle()})).catch((e=>(0,g.H4)(e,[],a.setError)))}}),(0,o.Y)(s.Form.ControlRow,{elementId:h.id,children:(0,o.Y)(s.Form.Control,{...h.props,autoFocus:!0,required:!0})}),(0,o.Y)(s.Form.ControlRow,{elementId:z.id,children:(0,o.Y)(s.Form.Control,{...z.props,onChange:e=>{var i;i=e.target.value,z.setValue(i),z.setError(void 0)},required:!0})}),(0,o.Y)(s.FormButtons,{isDisabled:!p})]})}),(0,o.Y)(s.SuccessPage,{title:e,text:(0,l.localizationKeys)("organizationProfile.profilePage.successMessage"),Breadcrumbs:c.p})]})}));var J=a(2234);const Z=()=>{var e,i;const{organizationSettings:a}=(0,r.useEnvironment)(),{organization:s}=(0,r.useCoreOrganization)(),{params:u}=(0,d.useRouter)(),g=n.useRef(),{data:m,isLoading:v}=(0,T.st)(null==s?void 0:s.getDomain,{domainId:u.id},{onSuccess(e){g.current={...e}}}),{domains:h}=(0,r.useCoreOrganization)({domains:{infinite:!0}});return s&&a?v||!m?(0,o.Y)(l.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$120}),children:(0,o.Y)(l.Spinner,{size:"lg",colorScheme:"primary"})}):(0,o.Y)(t.uj,{title:(0,J.GQ)("organizationProfile.removeDomainPage.title"),messageLine1:(0,J.GQ)("organizationProfile.removeDomainPage.messageLine1",{domain:null===(e=g.current)||void 0===e?void 0:e.name}),messageLine2:(0,J.GQ)("organizationProfile.removeDomainPage.messageLine2"),successMessage:(0,J.GQ)("organizationProfile.removeDomainPage.successMessage",{domain:null===(i=g.current)||void 0===i?void 0:i.name}),deleteResource:()=>null==m?void 0:m.delete().then((()=>{var e;return null===(e=null==h?void 0:h.revalidate)||void 0===e?void 0:e.call(h)})),breadcrumbTitle:(0,J.GQ)("organizationProfile.profilePage.domainSection.title"),Breadcrumbs:c.p}):null};var X=a(72);const ee=(e,{infoLabel:i})=>{const a=(null==e?void 0:e.totalPendingInvitations)||0;return 0===((null==e?void 0:e.totalPendingSuggestions)||0)+a?[]:[i,(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutInvitationCountLabel",{count:a}),(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutSuggestionCountLabel",{count:a})]},ie=(0,s.withCardStateProvider)((()=>{const e=(0,s.useCardState)(),{organizationSettings:i}=(0,r.useEnvironment)(),{membership:a,organization:n,domains:u}=(0,r.useCoreOrganization)({domains:{infinite:!0}}),{isAuthorizedUser:m}=(0,t.Zj)({permission:"org:sys_domains:manage"}),{navigateToFlowStart:v}=(0,T.Cb)(),{params:h,navigate:z,queryParams:p}=(0,d.useRouter)(),b=p.mode||"edit",f=(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),P="edit"===b,y=(0,g.tJ)("enrollmentMode","",{type:"radio",radioOptions:[...i.domains.enrollmentModes.includes("manual_invitation")?[{value:"manual_invitation",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.manualInvitationOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.manualInvitationOption__description")}]:[],...i.domains.enrollmentModes.includes("automatic_invitation")?[{value:"automatic_invitation",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticInvitationOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticInvitationOption__description")}]:[],...i.domains.enrollmentModes.includes("automatic_suggestion")?[{value:"automatic_suggestion",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticSuggestionOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticSuggestionOption__description")}]:[]]}),Y=(0,g.tJ)("deleteExistingInvitationsSuggestions","",{label:(0,l.localizationKeys)("formFieldLabel__organizationDomainDeletePending"),type:"checkbox"}),{data:S,isLoading:_}=(0,T.st)(null==n?void 0:n.getDomain,{domainId:h.id},{onSuccess(e){y.setValue(e.enrollmentMode)}}),D=Y.checked||(null==S?void 0:S.enrollmentMode)!==y.value,C=(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.subtitle",{domain:null==S?void 0:S.name}),x=ee(S,{infoLabel:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutInfoLabel")}),F=ee(S,{infoLabel:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.dangerTab.calloutInfoLabel")});return n&&i?_||!S?(0,o.Y)(l.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$120}),children:(0,o.Y)(l.Spinner,{size:"lg",colorScheme:"primary"})}):(S.verification&&"verified"===S.verification.status||v(),(0,o.Y)(s.ContentPage,{headerTitle:S.name,headerSubtitle:P?void 0:C,breadcrumbTitle:f,gap:4,Breadcrumbs:c.p,children:(0,o.Y)(l.Col,{gap:6,children:(0,o.FD)(s.Tabs,{children:[(0,o.FD)(s.TabsList,{children:[m&&(0,o.Y)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.start.headerTitle__enrollment")}),P&&m&&(0,o.Y)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.start.headerTitle__danger")})]}),(0,o.FD)(s.TabPanels,{children:[m&&(0,o.FD)(s.TabPanel,{sx:{width:"100%"},direction:"col",gap:4,children:[x.length>0&&(0,o.Y)(t.DD,{icon:K.Vk,children:x.map(((e,i)=>(0,o.Y)(l.Text,{as:"span",sx:[e=>({lineHeight:e.lineHeights.$short,color:"inherit",display:"block"})],localizationKey:e},i)))}),(0,o.Y)(s.Header.Root,{children:(0,o.Y)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.subtitle"),variant:"regularRegular"})}),(0,o.FD)(s.Form.Root,{onSubmit:async()=>{if(S&&n&&a&&u)try{await S.updateEnrollmentMode({enrollmentMode:y.value,deletePending:Y.checked}),await u.revalidate(),await z("../../")}catch(i){(0,g.H4)(i,[y],e.setError)}},gap:6,children:[(0,o.Y)(s.Form.ControlRow,{elementId:y.id,children:(0,o.Y)(s.Form.Control,{...y.props})}),P&&(0,o.Y)(s.Form.ControlRow,{elementId:Y.id,children:(0,o.Y)(s.Form.Control,{...Y.props})}),(0,o.Y)(s.FormButtons,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.formButton__save"),isDisabled:_||!S||!D})]})]}),P&&m&&(0,o.FD)(s.TabPanel,{direction:"col",gap:4,sx:{width:"100%"},children:[F.length>0&&(0,o.Y)(t.DD,{icon:K.Vk,children:F.map(((e,i)=>(0,o.Y)(l.Text,{as:"span",sx:[e=>({lineHeight:e.lineHeights.$short,color:"inherit",display:"block"})],localizationKey:e},i)))}),(0,o.Y)(l.Col,{sx:e=>({padding:`${e.space.$none} ${e.space.$4}`}),children:(0,o.Y)(X.T,{title:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.dangerTab.removeDomainTitle"),subtitle:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.dangerTab.removeDomainSubtitle"),actionLabel:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.dangerTab.removeDomainActionLabel__remove"),colorScheme:"danger",onClick:()=>z(`../../domain/${S.id}/remove`)})})]})]})]})})})):null}));var ae=a(9899);const oe=(0,s.withCardStateProvider)((()=>{var e;const i=(0,s.useCardState)(),{organizationSettings:a}=(0,r.useEnvironment)(),{organization:u}=(0,r.useCoreOrganization)(),{params:m,navigate:v}=(0,d.useRouter)(),[h,z]=n.useState(!1),{data:p,isLoading:b}=(0,T.st)(null==u?void 0:u.getDomain,{domainId:m.id}),f=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.title"),P=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.subtitle",{domainName:null!==(e=null==p?void 0:p.name)&&void 0!==e?e:""}),y=(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),Y=(0,T.mN)(),S=(0,g.tJ)("code",""),_=(0,s.useCodeControl)(S),D=(0,t.Xi)({onNextStep:()=>i.setError(void 0)}),C=(0,g.tJ)("affiliationEmailAddress","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationDomainEmailAddress"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationDomainEmailAddress"),infoText:(0,l.localizationKeys)("formFieldLabel__organizationDomainEmailAddressDescription")}),x=(0,n.useRef)(),K=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.subtitleVerificationCodeScreen",{emailAddress:x.current}),F=async()=>{z(!0),await(0,g.yy)(750)},R=async e=>{(0,g.H4)(e,[S],i.setError),Y.setIdle(),await(0,g.yy)(750),_.reset()};if(_.onCodeEntryFinished((e=>{Y.setLoading(),S.setError(void 0),((e,i,a)=>{var o;null===(o=null==p?void 0:p.attemptAffiliationVerification)||void 0===o||o.call(p,{code:e}).then((async e=>{var a;if(await i(),"verified"===(null===(a=e.verification)||void 0===a?void 0:a.status))return v(`../../../domain/${e.id}?mode=select`)})).catch((e=>a(e)))})(e,F,R)})),!u||!a)return null;const w=u.name!==C.value,L=`@${null==p?void 0:p.name}`;return b||!p?(0,o.Y)(l.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$120}),children:(0,o.Y)(l.Spinner,{size:"lg",colorScheme:"primary"})}):(0,o.FD)(t.sQ,{...D.props,children:[(0,o.Y)(s.ContentPage,{headerTitle:f,breadcrumbTitle:y,headerSubtitle:P,Breadcrumbs:c.p,children:(0,o.FD)(s.Form.Root,{onSubmit:e=>{if(e.preventDefault(),p)return x.current=`${C.value}${L}`,p.prepareAffiliationVerification({affiliationEmailAddress:x.current}).then(D.nextStep).catch((e=>{(0,g.H4)(e,[C],i.setError)}))},children:[(0,o.Y)(s.Form.ControlRow,{elementId:C.id,children:(0,o.Y)(s.Form.Control,{...C.props,autoFocus:!0,groupSuffix:`@${p.name}`,required:!0})}),(0,o.Y)(s.FormButtons,{isDisabled:!w})]})}),(0,o.FD)(s.ContentPage,{headerTitle:f,breadcrumbTitle:y,headerSubtitle:K,Breadcrumbs:c.p,children:[(0,o.Y)(ae.w,{title:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.formTitle"),subtitle:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.formSubtitle"),resendButton:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.resendButton"),isLoading:Y.isLoading,success:h,codeControl:_,onResendCodeClicked:()=>{_.reset(),null==p||p.prepareAffiliationVerification({affiliationEmailAddress:C.value}).catch((e=>{(0,g.H4)(e,[C],i.setError)}))}}),(0,o.Y)(s.FormButtonContainer,{children:(0,o.Y)(l.Button,{elementDescriptor:l.descriptors.formButtonReset,block:!1,variant:"ghost",textVariant:"buttonExtraSmallBold",type:"reset",isDisabled:Y.isLoading||h,onClick:()=>{S.clearFeedback(),_.reset(),D.prevStep()},localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset")})})]})]})})),ne=e=>{var i;const{pages:a,isMembersPageRoot:n,isSettingsPageRoot:l}=(0,r.useOrganizationProfileContext)(),c=null===(i=a.contents)||void 0===i?void 0:i.map(((e,i)=>{const a=!l&&!n&&0===i;return(0,o.Y)(d.Route,{index:a,path:a?void 0:e.url,children:(0,o.Y)(u.H,{mount:e.mount,unmount:e.unmount})},`custom-page-${e.url}`)}));return(0,o.Y)(s.ProfileCardContent,{contentRef:e.contentRef,children:(0,o.FD)(d.Switch,{children:[c,(0,o.FD)(d.Route,{children:[(0,o.Y)(d.Route,{path:l?void 0:"organization-settings",children:(0,o.FD)(d.Switch,{children:[(0,o.Y)(d.Route,{path:"profile",flowStart:!0,children:(0,o.Y)(t.iD,{permission:"org:sys_profile:manage",redirectTo:"../",children:(0,o.Y)(G,{})})}),(0,o.Y)(d.Route,{path:"domain",flowStart:!0,children:(0,o.FD)(d.Switch,{children:[(0,o.Y)(d.Route,{path:":id/verify",children:(0,o.Y)(t.iD,{permission:"org:sys_domains:manage",redirectTo:"../../",children:(0,o.Y)(oe,{})})}),(0,o.Y)(d.Route,{path:":id/remove",children:(0,o.Y)(t.iD,{permission:"org:sys_domains:manage",redirectTo:"../../",children:(0,o.Y)(Z,{})})}),(0,o.Y)(d.Route,{path:":id",children:(0,o.Y)(t.iD,{permission:"org:sys_domains:manage",redirectTo:"../../",children:(0,o.Y)(ie,{})})}),(0,o.Y)(d.Route,{index:!0,children:(0,o.Y)(t.iD,{permission:"org:sys_domains:manage",redirectTo:"../",children:(0,o.Y)(b,{})})})]})}),(0,o.Y)(d.Route,{path:"leave",flowStart:!0,children:(0,o.Y)(h,{})}),(0,o.Y)(d.Route,{path:"delete",flowStart:!0,children:(0,o.Y)(t.iD,{permission:"org:sys_profile:delete",redirectTo:"../",children:(0,o.Y)(z,{})})}),(0,o.Y)(d.Route,{index:!0,children:(0,o.Y)(j,{})})]})}),(0,o.Y)(d.Route,{path:n?void 0:"organization-members",children:(0,o.FD)(d.Switch,{children:[(0,o.Y)(d.Route,{path:"invite-members",flowStart:!0,children:(0,o.Y)(t.iD,{permission:"org:sys_memberships:manage",redirectTo:"../",children:(0,o.Y)(f.I,{})})}),(0,o.Y)(d.Route,{index:!0,children:(0,o.Y)(t.iD,{condition:e=>e({permission:"org:sys_memberships:read"})||e({permission:"org:sys_memberships:manage"}),redirectTo:l?"../":"./organization-settings",children:(0,o.Y)(V,{})})})]})})]})]})})},te=(0,r.withCoreUserGuard)((()=>{const e=n.useRef(null);return(0,o.Y)(s.ProfileCard,{sx:{height:"100%"},children:(0,o.Y)(c.l,{contentRef:e,children:(0,o.Y)(ne,{contentRef:e})})})})),re=(0,t.Z8)((0,t.$D)((0,s.withCardStateProvider)((e=>{const{organization:i}=(0,r.useCoreOrganization)();return i?(0,o.Y)(l.Flow.Root,{flow:"organizationProfile",children:(0,o.Y)(l.Flow.Part,{children:(0,o.Y)(d.Switch,{children:(0,o.Y)(d.Route,{children:(0,o.Y)(te,{})})})})}):null})),"OrganizationProfile",{mode:"redirect"})),le=e=>{const i={...e,routing:"virtual",componentName:"OrganizationProfile",mode:"modal"};return(0,o.Y)(d.Route,{path:"organizationProfile",children:(0,o.Y)(r.ComponentContext.Provider,{value:i,children:(0,o.Y)("div",{children:(0,o.Y)(re,{...i})})})})}},4683:function(e,i,a){a.d(i,{l_:function(){return n},mu:function(){return o},sZ:function(){return t}});const o={userMemberships:{infinite:!0},userInvitations:{infinite:!0},userSuggestions:{infinite:!0,status:["pending","accepted"]}},n=(e,i)=>void 0===i?[{data:[e],total_count:1}]:i.map((i=>{if(void 0===i)return i;const a=i.data.map((i=>i.id===e.id?{...e}:i));return{...i,data:a}})),t=(e,i)=>{var a;const o=null===(a=null==i?void 0:i[i.length-1])||void 0===a?void 0:a.total_count;if(o)return null==i?void 0:i.map((i=>{if(void 0===i)return i;const a=i.data.filter((i=>i.id!==e.id));return{...i,data:a,total_count:o-1}}))}},72:function(e,i,a){a.d(i,{T:function(){return r}});var o=a(4380),n=a(9333),t=a(7157);const r=e=>{const{title:i,subtitle:a,actionLabel:r,titleLabel:l,onClick:s,...d}=e,c=(0,t.mN)(),{t:u}=(0,n.useLocalizations)();return(0,o.FD)(n.Col,{gap:2,children:[(0,o.FD)(n.Col,{gap:1,children:[(0,o.FD)(n.Flex,{gap:2,align:"center",children:[(0,o.Y)(n.Text,{localizationKey:i,variant:"regularMedium"}),l]}),(0,o.Y)(n.Text,{localizationKey:a,variant:"smallRegular",colorScheme:"neutral"})]}),r&&(0,o.Y)(n.Button,{localizationKey:r,loadingText:u(r),colorScheme:"primary",variant:"link",...d,isLoading:c.isLoading,onClick:e=>{var i;c.setLoading(),s&&(null===(i=null==s?void 0:s(e))||void 0===i||i.finally((()=>c.setIdle())))}})]})}}}]);